<div class="flex relative" #top xmlns="http://www.w3.org/1999/html">
  <div class="w-full">

    <app-loading-overlay [loading]="loading"></app-loading-overlay>


    <p-stepper [value]="1" class="basis-[50rem]" *ngIf="!finish">
      <p-step-list class="px-10">
        <p-step [value]="1">{{ currentUrl === '/contratos/editar' ? 'Editar dados' : 'Inserir dados' }}</p-step>
        <p-step [value]="2"
                (click)="selectedIndex = null;">{{ currentUrl === '/contratos/editar' ? 'Adicionar Itens' : 'Selecionar Itens' }}
        </p-step>
        <p-step [value]="3"
                (click)="selectedIndex = null;">{{ currentUrl === '/contratos/editar' ? 'Editar Itens' : 'Revisão' }}
        </p-step>
      </p-step-list>
      <p-step-panels>
        <p-step-panel [value]="1">
          <ng-template #content let-activateCallback="activateCallback">
            <div class="flex flex-col gap-4 mx-auto px-4 sm:px-8" style="min-height: 16rem; max-width: 54rem">

              <!-- Título -->
              <div class="text-center mt-4 mb-2 text-lg sm:text-xl font-semibold">
                {{ currentUrl === '/contratos/editar' ? 'Editar os dados do contrato' : 'Digite os dados do contrato' }}
              </div>

              <!-- Número do contrato -->
              <div class="flex flex-col gap-1">
                <label class="text-sm font-medium text-surface-700 dark:text-surface-300">N.º Contrato*</label>
                <input [(ngModel)]="contract.number"
                       id="number"
                       type="text"
                       pInputText
                       autocomplete="off"
                       placeholder="Digite o número"
                       (input)="utils.formatContractNumber($event)"
                       required/>
              </div>

              <!-- Contratante -->
              <div class="flex flex-col gap-1">
                <label class="text-sm font-medium text-surface-700 dark:text-surface-300">Contratante*</label>
                <input [(ngModel)]="contract.contractor"
                       id="contractor"
                       type="text"
                       pInputText
                       autocomplete="off"
                       placeholder="Ex. Prefeitura de Belo Horizonte"
                       required/>
              </div>

              <!-- Endereço -->
              <div class="flex flex-col gap-1">
                <label class="text-sm font-medium text-surface-700 dark:text-surface-300">Endereço do
                  contratante*</label>
                <input [(ngModel)]="contract.address"
                       id="address"
                       type="text"
                       pInputText
                       autocomplete="off"
                       placeholder="Digite o endereço"
                       required/>
              </div>

              <!-- Telefone e CNPJ - lado a lado no desktop -->
              <div class="flex flex-col sm:flex-row gap-4">
                <div class="flex flex-col gap-1 w-full">
                  <label class="text-sm font-medium text-surface-700 dark:text-surface-300">Telefone do
                    Contratante*</label>
                  <input [(ngModel)]="contract.phone"
                         id="phone"
                         type="text"
                         pInputText
                         autocomplete="off"
                         (input)="utils.formatPhone($event)"
                         minlength="14"
                         maxlength="15"
                         placeholder="Ex. (31) 99999-9999"
                         required/>
                </div>

                <div class="flex flex-col gap-1 w-full">
                  <label class="text-sm font-medium text-surface-700 dark:text-surface-300">CNPJ do Contratante*</label>
                  <input [(ngModel)]="contract.cnpj"
                         id="cnpj"
                         type="text"
                         pInputText
                         autocomplete="off"
                         minlength="18"
                         maxlength="18"
                         (input)="utils.formatCNPJ($event)"
                         placeholder="Ex. 99.997.090/0001-99"
                         required/>
                </div>
              </div>

              <!-- Empresa contratada -->
              <div class="flex flex-col gap-1">
                <label class="text-sm font-medium text-surface-700 dark:text-surface-300">Empresa contratada*</label>
                <p-select id="companyId"
                          [options]="companies"
                          [(ngModel)]="contract.companyId"
                          optionLabel="socialReason"
                          optionValue="idCompany"
                          placeholder="Selecione a Empresa Prestadora"
                          class="w-full">
                  <ng-template #footer>
                    <div class="p-3">
                      <p-button label="Adicionar Nova Empresa"
                                icon="pi pi-plus"
                                text
                                size="small"
                                fluid
                                severity="secondary"
                                (click)="visible = true; utils.playSound('pop')"/>
                    </div>
                  </ng-template>
                </p-select>
              </div>

              <!-- Arquivos e botão unificado -->
              <div class="flex flex-col gap-4 mt-6">
                <div class="flex flex-col gap-1 w-full ">
                  <label class="text-sm font-medium text-surface-700 dark:text-surface-300">
                    Arquivos do Contrato
                  </label>

                  <div
                    class="rounded-lg border border-dashed border-surface-300 dark:border-surface-600 bg-surface-0 dark:bg-surface-900 p-3 sm:p-4">
                    <!-- input file escondido -->
                    <input
                      #fileInput
                      type="file"
                      multiple
                      accept=".pdf,.zip,application/pdf,application/zip"
                      (change)="onFilesSelected($event)"
                      class="hidden"
                      [attr.maxFileSize]="maxFileSize"
                    />

                    <!-- botão custom -->
                    <button
                      type="button"
                      class="p-button p-component p-button-sm p-button-success w-full flex items-center justify-center gap-2"
                      (click)="fileInput.click()"
                    >
                      <i class="pi pi-paperclip"></i>
                      Selecionar arquivos
                    </button>

                    <!-- feedback dos arquivos selecionados -->
                    <div *ngIf="selectedFiles.length === 0"
                         class="mt-2 text-xs text-center text-surface-500 dark:text-surface-400">
                      Aceita PDF ou ZIP • até 10MB
                    </div>
                    <ul *ngIf="selectedFiles.length > 0"
                        class="mt-2 text-xs text-surface-700 dark:text-surface-300 list-disc list-inside">
                      <li *ngFor="let file of selectedFiles">
                        {{ file.name }} ({{ (file.size / 1024 / 1024) | number:'1.1-2' }} MB)
                      </li>
                    </ul>
                  </div>
                </div>


                <div class="flex flex-col gap-1 w-full ">
                  <label class="text-sm font-medium text-surface-700 dark:text-surface-300">Serviço Unificado</label>
                  <span type="button"
                        class="btn btn-outline btn-primary btn-sm text-xs h-12 w-full flex items-center justify-center"
                        #unify
                        (click)="styleField(unify)">
                    Clique para ativar serviço unificado
                  </span>
                </div>

              </div>

              <div class="flex justify-end pt-6">
                <p-button label="Continuar"
                          icon="pi pi-arrow-right"
                          iconPos="right"
                          (onClick)="activateCallback(2)"/>
              </div>
            </div>
          </ng-template>
        </p-step-panel>


        <p-step-panel [value]="2">
          <ng-template #content let-activateCallback="activateCallback">
            <div>
              <p-table
                class="mt-4 text-sm"
                [value]="items"
                dataKey="contractItemId"
                editMode="row"
                responsiveLayout="scroll"
              >
                <ng-template pTemplate="header">
                  <tr class="text-left">
                    <th class="px-4 py-2 text-gray-700 dark:text-neutral-100 text-center"></th>
                    <th class="px-4 py-2 text-gray-700 dark:text-neutral-100 font-semibold text-base text-left">Descrição</th>
                    <th class="px-4 py-2 text-gray-700 dark:text-neutral-100 font-semibold text-base text-center">Quantidade</th>
                    <th class="w-48 px-4 py-2 text-gray-700 dark:text-neutral-100 font-semibold text-base text-center">Valor
                      unitário
                    </th>
                  </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item let-editing="editing" let-i="rowIndex">
                <tr [class.fade-out]="removingIndex === i"
                    [ngClass]="selectedIndex === i ? 'bg-[#ecfdf5] font-semibold text-[#047857] dark:bg-[#1c362f] dark:text-white' : ''"
                    (click)="selectedIndex = i"
                    [class]="item.type === 'SERVIÇO' && contract.unifyServices ? 'disabled' : ''"
                    [title]="item.type === 'SERVIÇO' && contract.unifyServices ? 'Serviço unificado ativado, este item foi desabilitado' : ''"
                    class="transition-all duration-400 hover:bg-[#ecfdf5] hover:dark:bg-[#1c362f] cursor-pointer">
                  <td class="px-4 py-2 text-center">
                    <button
                      type="button"
                      [disabled]="item.type === 'SERVIÇO' && contract.unifyServices"
                      aria-label="Adicionar item"
                      class="flex items-center justify-center
                               text-white bg-blue-600
                               hover:bg-blue-700 active:bg-blue-800
                               rounded-full p-2
                               transition-all transform hover:scale-110
                               focus:outline-none focus:ring-2 focus:ring-blue-400"
                      (click)="addItem(item, i)">

                        <span class="material-icons text-sm">
                          add
                        </span>
                    </button>
                  </td>


                  <td class="px-4 py-2 text-base">{{ item.description }}</td>

                  <td [pEditableColumn]="item.quantity" pEditableColumnField="quantity">
                    <p-cellEditor>
                      <!-- INPUT -->
                      <ng-template pTemplate="input">
                        <p-inputNumber
                          name="quantity{{i}}"
                          required
                          placeholder="Ex.: 12"
                          [(ngModel)]="item.quantity"
                          mode="decimal"
                          locale="pt-BR"
                          [minFractionDigits]="0"
                          [maxFractionDigits]="2"
                          inputStyleClass="w-24 text-right">
                        </p-inputNumber>
                      </ng-template>

                      <ng-template pTemplate="output">
                        <div class="group flex justify-end items-center gap-2 px-2 py-1 rounded-md
                                      cursor-pointer transition-all duration-200
                                      hover:bg-blue-50 hover:ring-1 hover:ring-blue-400
                                      dark:hover:bg-blue-500/10 dark:hover:ring-blue-400/40">
                              <span class="text-gray-800 dark:text-gray-100">
                                {{ item.quantity }}
                              </span>
                          <i class="pi pi-pencil text-xs
                              text-gray-400 dark:text-gray-500
                              opacity-0 group-hover:opacity-100
                              transition-opacity duration-200"></i>
                        </div>
                      </ng-template>
                    </p-cellEditor>
                  </td>


                  <td [pEditableColumn]="item.price" pEditableColumnField="price">
                    <p-cellEditor>
                      <!-- INPUT -->
                      <ng-template pTemplate="input">
                        <p-inputNumber
                          name="price{{i}}"
                          required
                          placeholder="Ex.: 12"
                          [(ngModel)]="item.price"
                          mode="decimal"
                          locale="pt-BR"
                          [minFractionDigits]="0"
                          [maxFractionDigits]="2"
                          inputStyleClass="w-24 text-right">
                        </p-inputNumber>
                      </ng-template>

                      <ng-template pTemplate="output">
                        <div class="group flex justify-end items-center gap-2 px-2 py-1 rounded-md
                                      cursor-pointer transition-all duration-200
                                      hover:bg-blue-50 hover:ring-1 hover:ring-blue-400
                                      dark:hover:bg-blue-500/10 dark:hover:ring-blue-400/40">
                              <span class="text-gray-800 dark:text-gray-100">
                                {{ item.price | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
                              </span>
                          <i class="pi pi-pencil text-xs
                              text-gray-400 dark:text-gray-500
                              opacity-0 group-hover:opacity-100
                              transition-opacity duration-200"></i>
                        </div>
                      </ng-template>
                    </p-cellEditor>
                  </td>

                </tr>
                </ng-template>
              </p-table>
            </div>


            <div class="flex pt-6 justify-between px-10">
              <p-button label="Voltar" severity="secondary" icon="pi pi-arrow-left"
                        (onClick)="activateCallback(1)"/>
              <p-button label="Próximo" icon="pi pi-arrow-right" iconPos="right"
                        (onClick)="activateCallback(3); selectedIndex = null;"/>
            </div>

          </ng-template>
        </p-step-panel>

        <p-step-panel [value]="3">
          <ng-template #content let-activateCallback="activateCallback">

            @if (contract.items.length > 0) {
              <div>
                <div class="flex justify-between mx-10">
                  <div class="text-xl font-semibold">Revise os itens adicionados</div>
                  <div class="flex flex-col">
                      <span class="uppercase tracking-wide text-sm font-semibold opacity-80">
                      Valor Total
                    </span>
                    <h2 class="text-3xl sm:text-3xl font-extrabold leading-tight drop-shadow-md">
                      {{ getTotalValue() | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
                    </h2>
                  </div>
                </div>

                <p-table
                  #dt
                  class="mt-4 text-sm"
                  [value]="contract.items"
                  dataKey="contractItemId"
                  editMode="row"
                  responsiveLayout="scroll"
                >
                  <ng-template pTemplate="header">
                    <tr>
                      <th
                        class="text-left px-3 py-2 text-gray-700 dark:text-neutral-100 font-semibold text-base text-center"></th>
                      <th class="px-4 py-2 text-gray-700 dark:text-neutral-100 font-semibold text-base text-left">
                        Descrição
                      </th>
                      <th class="px-4 py-2 text-gray-700 dark:text-neutral-100 font-semibold text-base text-center">
                        Quantidade
                      </th>
                      <th class="px-4 py-2 text-gray-700 dark:text-neutral-100 font-semibold text-base text-right"
                          *ngIf="currentUrl === '/contratos/editar'">Qtde. Executada
                      </th>
                      <th class="px-4 py-2 text-gray-700 dark:text-neutral-100 font-semibold text-base text-center">
                        Valor unitário
                      </th>
                    </tr>
                  </ng-template>
                  <ng-template pTemplate="body" let-item let-editing="editing" let-i="rowIndex">
                    <tr
                      [ngClass]="selectedIndex === i ? 'bg-[#ecfdf5] font-semibold text-[#047857] dark:bg-[#1c362f] dark:text-white' : ''"
                      (click)="selectedIndex = i"
                      [class.fade-out]="removingIndexContract === i"
                      class="transition-all duration-400 hover:bg-[#ecfdf5] hover:dark:bg-[#1c362f] cursor-pointer">
                      <td class="px-4 py-2 text-center">
                        <button
                          type="button"
                          aria-label="Remover item"
                          class="flex items-center justify-center
                        text-white bg-red-600
                        hover:bg-red-700 active:bg-red-800
                          rounded-full p-2
                          transition-all transform hover:scale-110
                          focus:outline-none focus:ring-2 focus:ring-red-400"
                          (click)="removeItem(item, i)">

                        <span class="material-icons text-xs">
                          delete
                        </span>
                        </button>
                      </td>

                      <td>{{ item.description }}</td>

                      <td [pEditableColumn]="item.quantity" pEditableColumnField="quantity" class="text-center">
                        <p-cellEditor>
                          <!-- INPUT -->
                          <ng-template pTemplate="input">
                            <p-inputNumber
                              name="quantity{{i}}"
                              required
                              placeholder="Ex.: 12"
                              mode="decimal"
                              locale="pt-BR"
                              [minFractionDigits]="0"
                              [maxFractionDigits]="2"
                              [(ngModel)]="item.quantity"
                              #quantityModel="ngModel"
                              [min]="item.executedQuantity > 0 ? item.executedQuantity : 1"
                              (ngModelChange)="checkMin(item, quantityModel)"
                              inputStyleClass="w-24 text-right">
                            </p-inputNumber>
                            <p-message *ngIf="quantityModel.control?.hasError('minCustom')" severity="error" styleClass="mt-2">
                              @if(item.executedQuantity > 0) {
                                A quantidade mínima é {{ item.executedQuantity }}<br>(total já executado ou reservado em O.S.).
                              }@else{
                                A quantidade mínima é 1
                              }
                            </p-message>

                          </ng-template>

                          <ng-template pTemplate="output">
                            <div class="group flex justify-end items-center gap-2 px-2 py-1 rounded-md
                                      cursor-pointer transition-all duration-200
                                      hover:bg-blue-50 hover:ring-1 hover:ring-blue-400
                                      dark:hover:bg-blue-500/10 dark:hover:ring-blue-400/40">
                              <span class="text-gray-800 dark:text-gray-100">
                                {{ item.quantity }}
                              </span>
                              <i class="pi pi-pencil text-xs
                              text-gray-400 dark:text-gray-500
                              opacity-0 group-hover:opacity-100
                              transition-opacity duration-200"></i>
                            </div>
                          </ng-template>
                        </p-cellEditor>
                      </td>

                      <td class="text-right"
                          *ngIf="currentUrl === '/contratos/editar'">{{ item.executedQuantity ?? 0 }}
                      </td>

                      <td [pEditableColumn]="item.price" pEditableColumnField="price">
                        <p-cellEditor>
                          <!-- INPUT -->
                          <ng-template pTemplate="input">
                            <p-inputNumber
                              name="price{{i}}"
                              required
                              placeholder="Ex.: 2,00"
                              [(ngModel)]="item.price"
                              mode="decimal"
                              locale="pt-BR"
                              [minFractionDigits]="2"
                              [maxFractionDigits]="2"
                              inputStyleClass="w-24 text-right">
                            </p-inputNumber>
                          </ng-template>

                          <ng-template pTemplate="output">
                            <div class="group flex justify-end items-center gap-2 px-2 py-1 rounded-md
                                      cursor-pointer transition-all duration-200
                                      hover:bg-blue-50 hover:ring-1 hover:ring-blue-400
                                      dark:hover:bg-blue-500/10 dark:hover:ring-blue-400/40">
                              <span class="text-gray-800 dark:text-gray-100">
                                {{ item.price | currency:'BRL':'symbol':'1.2-2':'pt-BR' }}
                              </span>
                              <i class="pi pi-pencil text-xs
                              text-gray-400 dark:text-gray-500
                              opacity-0 group-hover:opacity-100
                              transition-opacity duration-200"></i>
                            </div>
                          </ng-template>
                        </p-cellEditor>
                      </td>

                    </tr>
                  </ng-template>

                </p-table>
              </div>
            } @else {
              <div
                class="w-full max-w-md mx-auto bg-green-100 border border-green-400 text-orange-800 p-4 rounded-lg
                shadow-md flex flex-col items-center text-center gap-4">
                <div class="flex items-center gap-3">
                  <i class="fa-solid fa-xmark"></i>
                  <div>
                    <p class="text-sm">Nenhum item adicionado</p>
                  </div>
                </div>
              </div>
            }

            <div class="flex pt-6 justify-between px-10">
              <p-button label="Voltar" icon="pi pi-arrow-left" iconPos="right"
                        (onClick)="activateCallback(2); selectedIndex = null"/>

              <p-button label="Salvar" icon="pi pi-save" iconPos="left" severity="info"
                        *ngIf="contract.items.length > 0"
                        (onClick)="openConfirmModal()"/>
            </div>
          </ng-template>
        </p-step-panel>
      </p-step-panels>
    </p-stepper>

    <app-prime-confirm-dialog
      *ngIf="openModal"
      [message]="'Confirma o salvamento do contrato?'"
      (action)="handleAction($event)"
      type="confirm">
    </app-prime-confirm-dialog>

    <div *ngIf="finish" class="flex flex-col justify-center items-center h-[calc(100vh-500px)]">
      <div *ngIf="finish"
           class="w-full max-w-md mx-auto bg-green-100 border border-green-400 text-green-800 p-4 rounded-lg shadow-md flex flex-col items-center text-center gap-4">
        <div class="flex items-center gap-3">
          <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"
               xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"></path>
          </svg>
          <div>
            <h3 class="text-lg font-semibold">Sucesso!</h3>
            @if (currentUrl === '/contratos/editar') {
              <p class="text-sm">O contrato foi atualizado com sucesso.</p>
            } @else {
              <p class="text-sm">O contrato foi criado com sucesso.</p>
            }
          </div>
        </div>
      </div>

      <div class="flex flex-col gap-2 mt-10">
        <button (click)="finish=false" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
          Criar Novo Contrato
        </button>
        <button class="bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition"
                (click)="router.navigate(['contratos/listar'],{ queryParams: { for: 'view' } });">
          Ver Contratos Criados
        </button>
      </div>

    </div>


    <p-toast/>

    <!--    Cadastrar empresa-->
    <p-dialog [(visible)]="visible" [modal]="false" [style]="{ width: '35rem' }" position="left">
      <ng-template #header>
        <div class="inline-flex items-center justify-center gap-2">
          <span class="font-bold whitespace-nowrap">Cadastrar Empresa</span>
        </div>
      </ng-template>

      <span class="text-surface-500 dark:text-surface-400 block mb-8">Preencha as informações abaixo</span>

      <div class="flex flex-col gap-4 mx-auto" style="min-height: 16rem; max-width: 50rem;">

        <!-- Razão Social -->
        <div class="flex flex-col gap-1">
          <label for="socialReason" [class.text-red-500]="companyFormSubmit && socialReasonCtrl.invalid">Razão
            Social*</label>
          <input [(ngModel)]="company.socialReason"
                 (input)="company.socialReason = company.socialReason.toUpperCase()"
                 #socialReasonCtrl="ngModel"
                 id="socialReason"
                 type="text"
                 pInputText
                 autocomplete="off"
                 placeholder="Digite a razão social"
                 required
                 [ngClass]="{'ng-invalid ng-dirty': companyFormSubmit && socialReasonCtrl.invalid}"/>
        </div>

        <!-- Nome Fantasia -->
        <div class="flex flex-col gap-1">
          <label for="fantasyName" [class.text-red-500]="companyFormSubmit && fantasyNameCtrl.invalid">Nome
            Fantasia*</label>
          <input [(ngModel)]="company.fantasyName"
                 (input)="company.fantasyName = company.fantasyName.toUpperCase()"
                 #fantasyNameCtrl="ngModel"
                 id="fantasyName"
                 type="text"
                 pInputText
                 autocomplete="off"
                 placeholder="Digite o nome fantasia"
                 required
                 [ngClass]="{'ng-invalid ng-dirty': companyFormSubmit && fantasyNameCtrl.invalid}"/>
        </div>

        <!-- CNPJ -->
        <div class="flex flex-col gap-1">
          <label for="companyCnpj" [class.text-red-500]="companyFormSubmit && cnpjCtrl.invalid">CNPJ*</label>
          <input [(ngModel)]="company.companyCnpj"
                 #cnpjCtrl="ngModel"
                 id="companyCnpj"
                 type="text"
                 pInputText
                 autocomplete="off"
                 placeholder="Digite o CNPJ"
                 minlength="18"
                 maxlength="18"
                 (input)="utils.formatCNPJ($event)"
                 required
                 [ngClass]="{'ng-invalid ng-dirty': companyFormSubmit && cnpjCtrl.invalid}"/>
        </div>

        <!-- Telefone -->
        <div class="flex flex-col gap-1">
          <label for="companyPhone" [class.text-red-500]="companyFormSubmit && phoneCtrl.invalid">Telefone*</label>
          <input [(ngModel)]="company.companyPhone"
                 #phoneCtrl="ngModel"
                 id="companyPhone"
                 type="text"
                 pInputText
                 autocomplete="off"
                 minlength="14"
                 maxlength="15"
                 placeholder="(00) 00000-0000"
                 (input)="utils.formatPhone($event)"
                 required
                 [ngClass]="{'ng-invalid ng-dirty': companyFormSubmit && phoneCtrl.invalid}"/>
        </div>

        <!-- Contato -->
        <div class="flex flex-col gap-1">
          <label for="companyContact" [class.text-red-500]="companyFormSubmit && contactCtrl.invalid">Contato*</label>
          <input [(ngModel)]="company.companyContact"
                 #contactCtrl="ngModel"
                 id="companyContact"
                 type="text"
                 pInputText
                 autocomplete="off"
                 placeholder="Nome do responsável"
                 required
                 [ngClass]="{'ng-invalid ng-dirty': companyFormSubmit && contactCtrl.invalid}"/>
        </div>

        <!-- E-mail -->
        <div class="flex flex-col gap-1">
          <label for="companyEmail" [class.text-red-500]="companyFormSubmit && emailCtrl.invalid">E-mail*</label>
          <input [(ngModel)]="company.companyEmail"
                 #emailCtrl="ngModel"
                 required
                 id="companyEmail"
                 type="email"
                 pInputText
                 [ngClass]="{'ng-invalid ng-dirty': companyFormSubmit && emailCtrl.invalid}"
                 autocomplete="off"
                 placeholder="exemplo@empresa.com"/>
        </div>

        <!-- Endereço -->
        <div class="flex flex-col gap-1">
          <label for="companyAddress" [class.text-red-500]="companyFormSubmit && addressCtrl.invalid">Endereço*</label>
          <input [(ngModel)]="company.companyAddress"
                 #addressCtrl="ngModel"
                 id="companyAddress"
                 type="text"
                 pInputText
                 autocomplete="off"
                 placeholder="Rua, número, bairro, cidade"
                 required
                 [ngClass]="{'ng-invalid ng-dirty': companyFormSubmit && addressCtrl.invalid}"/>
        </div>

        <!-- Logo da Empresa -->
        <div class="flex flex-col gap-1 mt-5 mr-4">
          <input type="file"
                 class="file-input file-input-sm hidden"
                 accept=".png,.jpg"
                 #inputLogo
                 (change)="onLogoSelected($event)"/>

          <label for="contractFile" [class.text-red-500]="companyFormSubmit && !logoFile">Logo da Empresa*</label>
          <span
            (click)="inputLogo.click()"
            type="button"
            [class.btn-outline]="!logoFile"
            [ngClass]="{'ng-invalid ng-dirty border border-red-500': companyFormSubmit && !logoFile}"
            class="btn btn-accent btn-sm text-xs w-full h-12 flex items-center justify-center gap-2">
      <span class="material-icons" *ngIf="logoFile === null">cloud_upload</span>
            {{ logoFile?.name || 'Clique para selecionar' }}
    </span>
        </div>

      </div>


      <ng-template #footer>
        <p-button label="Cancelar" [text]="true" severity="secondary" (click)="visible = false; resetCompanyForm();"/>
        <p-button label="Salvar" [outlined]="true" severity="secondary" [loading]="btnLoading" (click)="saveCompany()"/>
      </ng-template>
    </p-dialog>

  </div>
</div>

